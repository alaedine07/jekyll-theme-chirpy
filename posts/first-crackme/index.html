<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Solve your first Crackme" /><meta name="author" content="alaedine" /><meta property="og:locale" content="en_US" /><meta name="description" content="Hi everyone. In this blog post I will be explaining how to solve a simple beginner crackme." /><meta property="og:description" content="Hi everyone. In this blog post I will be explaining how to solve a simple beginner crackme." /><link rel="canonical" href="/posts/first-crackme/" /><meta property="og:url" content="/posts/first-crackme/" /><meta property="og:site_name" content="alaedine" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-03-08T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Solve your first Crackme" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"alaedine"},"headline":"Solve your first Crackme","dateModified":"2021-03-09T02:19:35+01:00","datePublished":"2021-03-08T00:00:00+01:00","description":"Hi everyone. In this blog post I will be explaining how to solve a simple beginner crackme.","url":"/posts/first-crackme/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/first-crackme/"},"@context":"https://schema.org"}</script><title>Solve your first Crackme | alaedine</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/icon.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">alaedine</a></div><div class="site-subtitle font-italic">just another IT guy</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/alaedine07" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://www.linkedin.com/in/boufaden-alaedine-7b6b03205/" aria-label="linkedin" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Solve your first Crackme</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Solve your first Crackme</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Mar 8, 2021, 12:00 AM +0100" > Mar 8 <i class="unloaded">2021-03-08T00:00:00+01:00</i> </span> by <span class="author"> alaedine </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Tue, Mar 9, 2021, 2:19 AM +0100" > Mar 9 <i class="unloaded">2021-03-09T02:19:35+01:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2121 words">11 min</span></div></div><div class="post-content"><p>Hi everyone. In this blog post I will be explaining how to solve a simple beginner crackme.</p><h2 id="reverse-engineering">Reverse engineering</h2><p>What we will be doing now is called <a href="https://en.wikipedia.org/wiki/Reverse_engineering"><strong>reverse engineering</strong></a>. As a programmer you develop you program by first making a design of it, you try to understand first how your program will behave in a lot of conditions, then you will implement this design into code with the help of a programming language which will produce a final executable/website/hardware… that you deliver to the users. So the users knows nothing about how your product was designed, how the code is written and implemented, they only see what you want them to see, they only give inputs and get output.</p><p>But there is one users who is Not OK with that. he want to understand how your program was made and try to mimic the source code. maybe he is just doing that for his own curiosity, maybe he want to Patch the executable and add new features to it, maybe he is trying to bypass a security check that you are using (licence key, password verification, custom encryption …), Or even another company who got jealous after seeing your product on the market and they are trying to know how it works so they can make their own and maybe even a better one.</p><p>what all this people will try to do is <strong>reverse engineering</strong> your product. they will try to understand what he is doing based on the input/output and using other tools made for this purpose.</p><p>Reversing is an <em>art</em></p><h2 id="prerequisite">Prerequisite</h2><p>Tho I will try to make it really simple and explain a lot of terms, but a Basic understanding of assembly will make reading this article more enjoyable and a better learning experience to you. I added links at the end of the Post to learn assembly both youtube videos and blog posts. also a really basic GDB manipulation is required, and of course programming</p><h2 id="lets-go">Let’s Go</h2><p>I will take this <a href="https://github.com/holbertonschool/0x04.c/blob/master/101-crackme">cracke me file</a> as an example here.</p><h3 id="checking-the-behaviour">Checking the behaviour</h3><p>so we have an executable file that we want to know how it’s working, the first thing to do is to interact with it. let’s try to execute it first</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/crackme/enum1.png" alt="" /></p><p>so we can already see that it want us to provide an argument called password let’s do that.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/crackme/enum2.png" alt="" /></p><p>so we sent the password but it’s a wrong one, we could make our computer spend all the night trying millions of passwords but that’s dumb and it’s not the purpose of reversing. another good thing to know is information about the executable we are dealing with. using the command <code class="language-plaintext highlighter-rouge">file</code> is enough to get a quick idea.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/crackme/file_command.png" alt="" /></p><p>A 64-bit executable, dynamically linked and not stripped.</p><h3 id="breakpoint">Breakpoint</h3><p>Dynamically linked means that the binary is relying on shared-libraries to do some parts of the job. Now the opposite of dynamically linked is statically linked.</p><p>Statically linked means that the binaries is not in need of external libraries to work. Meaning it has all the dependencies within it.</p><p>Not stripped means that the binary has debugging symbols, and that makes debugging it easier. The opposite of that is stripped.</p><p>Stripped means that the binary is not having debugging symbols which makes it harder to reverse and debug. For example there would be no function names in a stripped binary and you would need to predict the functions based on their functionalities.</p><h3 id="debugging-time">Debugging time</h3><p>So after having a basic idea of what that executable is doing, we will open the file in GDB with <code class="language-plaintext highlighter-rouge">gdb 101-crackme</code>. GDB offers extensive facilities for tracing and altering the execution of computer programs. The user can monitor and modify the values of programs’ internal variables, and even call functions independently of the program’s normal behavior.</p><p>first let’s check the functions used on this binary with <code class="language-plaintext highlighter-rouge">info functions</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/crackme/gdb1.png" alt="" /></p><p>there is a lot of functions we don’t know about. they are all added by the shared library, but there is a <strong>main</strong> and <strong>checksum</strong> functions that are surely created by the programmer.</p><p>let’s also check the global variables used this file with <code class="language-plaintext highlighter-rouge">info variables</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/crackme/gdb_variables.png" alt="" /></p><p>Uh!!! nothing interesting let’s move on and disassemble the main functions which is the entry function.</p><h3 id="breakpoint-1">Breakpoint</h3><p>in a certain era, C(which is considered a low level programming language) was considered high level because people were coding in Assembly, compiling the code will turn the C code into assembly instructions which is the closest thing to machine language. Saying the word disassemblying means that i will check the result of the code at an assembly level. here I will use the INTEL syntax not the AT&amp;T because I find it more clear</p><h3 id="understanding-main">Understanding main</h3><p>let’s use the command <code class="language-plaintext highlighter-rouge">set disassembly-flavor intel</code> to set the assembly into INTEL syntax and then use the command <code class="language-plaintext highlighter-rouge">disassemble main</code> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/crackme/disas-main.png" alt="" /></p><p>Oh WTF is that!!!. calm down it’s the assembly of the main functions. we don’t need to understand all of it now we will just take what we need. do you see that line <code class="language-plaintext highlighter-rouge">cmp DWORD PTR [rbp-0x14],0x2</code> it’s comparing something with 2… think about what could be compared with 2. the <em>ARGUMENT</em> yes !!! we can translate this with <code class="language-plaintext highlighter-rouge">if argc == 2</code> which mean we have entered an argument, the next line is <code class="language-plaintext highlighter-rouge">je 0x4005d2 &lt;main+53&gt;</code>. <strong>je</strong> stands for JUMP if Equal. and this line will jump to the instruction after 53 line from the starting of main. but what could happen if it’s not equal to 2?? well it will not execute the JUMP and start executing what is next from the line +21. we can see that after few instructions it call <strong>printf</strong> think about it what could that printf be used for ?? the <em>ERROR Message</em> yes !!! which is <code class="language-plaintext highlighter-rouge">Usage: ./101-crackme password</code> after that it will jump to the line main+118 which is a LEAVE instructions it means the program will quit the <strong>function</strong> in this case if the program quit main it means it will quit the execution.</p><p>now let’s go back to the line +53. the instruction <code class="language-plaintext highlighter-rouge">mov rax,QWORD PTR [rbp-0x20]</code> means that it will move something from the stack to the <strong>rax</strong> register(register are the memory space used directly by the processor). after few other instructions it will call the function <strong>checksum</strong>. let’s see what’s happening here by adding a breakpoint in the instruction that call checksum. gdb will stop the program just before executing the instruction and we can examine the memory there. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/crackme/first-break.png" alt="" /></p><p>Don’t panic I will tell what we did. first we added a breakpoint on the instruction that call <strong>checksum</strong> with <code class="language-plaintext highlighter-rouge">break *0x00000000004005e0</code> then i started the program with ABCD as argument with <code class="language-plaintext highlighter-rouge">start ABCD</code>. gdb by default break at main if it exists so i had to use <code class="language-plaintext highlighter-rouge">continue</code> to move on the running. then it hits another breakpoint which is the one i set . after that i examined the register <em>rax</em> with <code class="language-plaintext highlighter-rouge">x/s $rax</code> (<em>x</em> stands for examine and <em>s</em> is the type string) and we can notice that rax contains “ABCD” which is the argument i passed. also <em>rdi</em>(another processor register) have “ABCD” because there is an instruction executed <code class="language-plaintext highlighter-rouge">mov rdi, rax</code> which put the value of <em>rax</em> into <em>rdi</em></p><h3 id="understanding-checksum">Understanding checksum</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/crackme/disas-checksum.png" alt="" /></p><p>from the pattern of this function we can deduce that it’s doing a loop. WAIT how did you know that!!!. ok so first with the line <code class="language-plaintext highlighter-rouge">mov QWORD PTR [rbp-0x8],0x0</code> it seems like the function is initializing something to 0 (maybe a sum??), then the function will jump to the line +38 and do some instructions there, we can see also the line <code class="language-plaintext highlighter-rouge">add QWORD PTR [rbp-0x18],0x1</code> which basically add 1 to where our string is used so it’s like <code class="language-plaintext highlighter-rouge">chr++</code> with <em>chr</em> as pointer to string. then it will make a test <code class="language-plaintext highlighter-rouge">test al, al</code> this instructions is used to check if a value is 0. if it’s not 0 (<em>jne</em> stands for jump not equal), it will go back to +18. I guess you get the pattern here ? YES you are right!!! it’s looping a string(the argument) until it’s end(NULL byte). but what’s happening in that loop??. that’s when GDB become very helpful…</p><p>I switched to this layout by using the command <code class="language-plaintext highlighter-rouge">layout next</code> 3 or 2 times it will help me to see the registers and memory state at the same time the program is running. you can step the instructions line by line with the command <code class="language-plaintext highlighter-rouge">ni</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/crackme/layout.png" alt="" /></p><p>after a lot of times debugging, adding breakpoints, checking register i was able to find something out of this</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/crackme/here.png" alt="" /></p><p>we can see that the buffer on the stack(variable) used to sum which is <em>rbp-0x8</em> is getting the value <strong>0x41</strong> after the 1st iteration which is 61 in decimal which corresponds to <em>A</em> in ASCII and it becomes <strong>0x83</strong>(131 in decimal) after the second iteration which is 65 + 66 which corresponds to ascii(A) + ascii(B). i’m using the command <code class="language-plaintext highlighter-rouge">x/wx $rbp-0x8</code> to get the value of rbp in HEX. to replicate this and after adding a breakpoint on checksum.</p><ol><li>you need to add a breakpoint at <code class="language-plaintext highlighter-rouge">0x0000000000400587 &lt;+33&gt;: add QWORD PTR [rbp-0x18],0x1</code><li>keep stepping with <code class="language-plaintext highlighter-rouge">ni</code><li>when you hit the breakpoint check the value of sum with <code class="language-plaintext highlighter-rouge">x/wx $rbp-0x8</code></ol><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/crackme/final-1.png" alt="" /></p><p>now we are in the instructions before the return. the rax register is holding the return value of the function checksum which is 0x10a(266 in decimal) which is equal to ascii(A)+ascii(B)+ascii(C)+ascii(D) this means that the function checksum return the sum of ascii values of the argument string.(finally)</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/crackme/cmp-break.png" alt="" /></p><p>after executing checksum, the result will be saved on <em>$rbp-0x8</em> and then it will be compared with <em>0xad4</em>(2772 in decimal)</p><h3 id="breakpoint-2">Breakpoint</h3><p>after all what we did we can fineally understand what this program is doing.</p><ol><li><p>take a string as an argument</p><li><p>make a sum from the ascii values of the argument characters</p><li><p>compare it with 2772</p><li><p>if it’s not 2772 than the password is false</p></ol><p>so if we want to beat this check . our argument must contains characters that if summed together their ascii value must be 2772.</p><p>take your time to solve this before reading the solution, redo the same steps with gdb again and again….</p><h3 id="keygen">keygen</h3><p>so now after understanding what this binary is doing and checking. we will create keygen that will generate a new valid password every time it’s executed . I coded this <a href="https://github.com/alaedine07/holbertonschool-low_level_programming/blob/main/0x05-pointers_arrays_strings/101-keygen.c"><strong>keygen</strong></a>. let’s try to understand it.</p><p>first the code will generate a random number from a seed(that’s how it’s done in C I didn’t came up with that), then with a mathematical operation we can reduce the value of that number to make it fit on a range of ascii chars after 57 <code class="language-plaintext highlighter-rouge">number = rand() % 58 + 65;</code>. after that this ascii value will be added to variable <code class="language-plaintext highlighter-rouge">somme</code>, this process will be repeated until somme is equal to 2772. But this code isn’t really precise because <strong>somme</strong> can be added with a value that will make it greater than 2772. to get around that I wrapped all the process in a <code class="language-plaintext highlighter-rouge">while (somme != 2772)</code> it means that if <code class="language-plaintext highlighter-rouge">somme</code> become greater than 2772 all the process will be repeated from 0.</p><p>let’s see the example here:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/crackme/congrats.png" alt="" /></p><p>we can see that the process was repeated 155 times before finding a string that the somme of it’s char is equal to 2772. the first time it found a match after 4 tries, I guess i was just lucky there.</p><p>but when adding that string to the argument of the crackme file it didn’t work !!!. well we can notice that there is a <em>`</em> in the string, just escaping it will do the trick and we get Tada! congrats</p><p>well we don’t want to copy the string from keygen every time like that, we want to pass the keygen as an argument and it will do all the work directly.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/crackme/final.png" alt="" /></p><p>first i made the keygen only print the valid string and passed it as an argument <code class="language-plaintext highlighter-rouge">./a.out</code> to crackme file but wait a minute that’s not how it works… we don’t want to pass litearlly “./a.out” but we need the result of <code class="language-plaintext highlighter-rouge">./a.out</code> so let’s wrap the argument inside <code class="language-plaintext highlighter-rouge">$()</code> so it get executed before the keygen file . this means that the argument of <code class="language-plaintext highlighter-rouge">./101-crackme</code> will be the result of <code class="language-plaintext highlighter-rouge">./a.out</code> which is the valid string printed.</p><p>Holééé the crackme if fineally solved it, was great challenge to get an introduction to reversing, assembly, gdb and thinking out of the box I hope you enjoyed this Post and learned new things.</p><h2 id="resources">Resources</h2><p><a href="https://www.youtube.com/watch?v=6jSKldt7Eqs&amp;ab_channel=LiveOverflow">quick introduction about how cpu works by liveoverflow</a></p><p><a href="https://asmtutor.com/">asm tutor course </a></p><p><a href="https://0xax.github.io/asm_1/">a great blog serie</a></p><p><a href="https://www.youtube.com/watch?v=wLXIWKUWpSs&amp;list=PLmxT2pVYo5LB5EzTPZGfFN0c2GDiSXgQe&amp;ab_channel=DavyWybiral">a great and detailed intel assembly youtube playlist</a></p><p><a href="https://www.youtube.com/watch?v=VroEiMOJPm8&amp;ab_channel=LiveOverflow">reversing a simple crackme with pen and paper by liveoverflow</a></p><p>And of course the mighty google</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/explained/'>explained</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/under-the-hood/" class="post-tag no-text-decoration" >under the hood</a> <a href="/tags/low-level/" class="post-tag no-text-decoration" >low level</a> <a href="/tags/c/" class="post-tag no-text-decoration" >C</a> <a href="/tags/programming/" class="post-tag no-text-decoration" >programming</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/security/" class="post-tag no-text-decoration" >security</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Solve your first Crackme - alaedine&url=/posts/first-crackme/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Solve your first Crackme - alaedine&u=/posts/first-crackme/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Solve your first Crackme - alaedine&url=/posts/first-crackme/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/process_loading/">Process loading in linux</a><li><a href="/posts/linux-direc/">linux directories explained</a><li><a href="/posts/type-ls/">What happens when you type ls in the shell?</a><li><a href="/posts/first-crackme/">Solve your first Crackme</a><li><a href="/posts/welcome-to-my-blog/">Welcome to my blog!</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/under-the-hood/">under the hood</a> <a class="post-tag" href="/tags/c/">C</a> <a class="post-tag" href="/tags/low-level/">low level</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/security/">security</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/static-libraries/"><div class="card-body"> <span class="timeago small" > Mar 6 <i class="unloaded">2021-03-06T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>C static libraries . Definition and how to use them</h3><div class="text-muted small"><p> Hello guys, in this Post I will explain what are libraries, why we use them and how to create a custom one. what is a library Libraries consist of a set of related functions to perform a common t...</p></div></div></a></div><div class="card"> <a href="/posts/typing-gcc/"><div class="card-body"> <span class="timeago small" > Mar 6 <i class="unloaded">2021-03-06T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>What happens when you type gcc main.c ?</h3><div class="text-muted small"><p> Hi everyone. In this blog post I will be explaining what happens when you compile your C program with gcc . What is Gcc ? First GCC is the GNU COMPILER COLLECTION it’s a set of compilers who can ...</p></div></div></a></div><div class="card"> <a href="/posts/understanding-soft-and-hard-links/"><div class="card-body"> <span class="timeago small" > Mar 6 <i class="unloaded">2021-03-06T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Understanding soft and hard links in linux and how they are used?</h3><div class="text-muted small"><p> One of the concepts a person will surely encounter on his journey of learning linux is dealing with soft or hard links . It easily confuse people so I hope this Post will make it more clear :) Har...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/passwd-shadow/" class="btn btn-outline-primary" prompt="Older"><p>What is /etc/passwd and /etc/shadow files</p></a> <a href="/posts/linux-direc/" class="btn btn-outline-primary" prompt="Newer"><p>linux directories explained</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/username">alaedine</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."> Some rights reserved. </span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/under-the-hood/">under the hood</a> <a class="post-tag" href="/tags/c/">C</a> <a class="post-tag" href="/tags/low-level/">low level</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/security/">security</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
